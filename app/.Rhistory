draft <- select(draft,Year,Round,Pick,Name,Team,WR,RB,QB,TE,DEF,K)
proj <- projections %>%
plyr::rename(c('player' = 'Name','team' = 'Team','playerposition' = 'POS','points' = 'Proj_Pts')) %>%
select(Year,Name,Proj_Pts)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name')) %>%
left_join(.,proj, by = c('Year' = 'Year','Name' = 'Name'))
View(all)
View(actuals)
View(draft)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
View(all)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
View(all)
test <- all[is.na(all$Fantasy_Pts)]
test <- all[is.na(all$Fantasy_Pts,)]
test <- all[is.na(all$Fantasy_Pts),]
View(test)
source(file = 'actuals.R')
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
test <- all[is.na(all$Fantasy_Pts),]
View(test)
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
test <- all[is.na(all$Fantasy_Pts),]
View(test)
View(actuals)
source(file = 'actuals.R')
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
test <- all[is.na(all$Fantasy_Pts),]
View(test)
source(file = 'actuals.R')
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
projections <- read.csv(file = "data/Projections.csv")
library(shiny)
library(shinyjs)
library(shinyFiles)
library(rsconnect)
library(reshape2)
require(plyr)
library(dplyr)
library(DT)
library(data.table)
library(ggplot2)
library(ggthemes)
library(scales)
library(googleVis)
library(rvest)
library(xml2)
library(XML)
library(plotly)
library(DT)
library(tidyr)
library(stringr)
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
projections <- read.csv(file = "data/Projections.csv")
View(projections)
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,Team,WR,RB,QB,TE,DEF,K)
proj <- projections %>%
plyr::rename(c('player' = 'Name','team' = 'Team','playerposition' = 'POS','points' = 'Proj_Pts')) %>%
select(Year,Name,Proj_Pts)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
proj$Name <- trim(proj$Name)
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
test <- all[is.na(all$Fantasy_Pts),]
View(test)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
View(Draft_Actuals)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
proj$Name <- trim(proj$Name)
View(Draft_Actuals)
Draft_Actuals[is.na(Draft_Actuals$Fantasy_Pts)] <- 0 #missing actuals for players drafted and did not play
Draft_Actuals[is.na(Draft_Actuals$Fantasy_Pts)] <- 0 #missing actuals for players drafted and did not play
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
View(Draft_Actuals)
View(Draft_Actuals)
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name'))
View(Draft_Act_Proj)
test <- Draft_Act_Proj[is.na(Draft_Act_Proj$Proj_Pts),]
View(test)
projections <- read.csv(file = "data/Projections.csv")
proj <- projections %>%
plyr::rename(c('player' = 'Name','team' = 'Team','playerposition' = 'POS','points' = 'Proj_Pts')) %>%
select(Year,Name,Proj_Pts)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
proj$Name <- trim(proj$Name)
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name'))
test <- Draft_Act_Proj[is.na(Draft_Act_Proj$Proj_Pts),]
View(test)
Ave_Def <- projections %>%
filter(Year > 2013, POS == "DST") %>%
group_by(Name) %>%
summarize(Average = mean(Proj_Pts))
proj <- projections %>%
plyr::rename(c('player' = 'Name','team' = 'Team','playerposition' = 'POS','points' = 'Proj_Pts')) %>%
select(Year,Name,Proj_Pts)
Ave_Def <- projections %>%
filter(Year > 2013, POS == "DST") %>%
group_by(Name) %>%
summarize(Average = mean(Proj_Pts))
Ave_Def <- proj %>%
filter(Year > 2013, POS == "DST") %>%
group_by(Name) %>%
summarize(Average = mean(Proj_Pts))
proj <- projections %>%
plyr::rename(c('player' = 'Name','team' = 'Team','playerposition' = 'POS','points' = 'Proj_Pts')) %>%
select(Year,Name,Proj_Pts)
Ave_Def <- projections %>%
filter(Year > 2013, playerposition == "DST") %>%
group_by(Name) %>%
summarize(Average = mean(points))
Ave_Def <- projections %>%
filter(Year > 2013, playerposition == "DST") %>%
group_by(player) %>%
summarize(Average = mean(points))
View(Ave_Def)
View(proj)
Ave_Def <- projections %>%
filter(Year > 2013, playerposition == "DST") %>%
group_by(player) %>%
summarize(Ave_Def = mean(points))
#Calculate average defense projections for 2014 to 2016: Impute average score for 2012 and 2013 with no data
Ave_K <- projections %>%
filter(Year > 2013, playerposition == "K") %>%
group_by(player) %>%
summarize(Ave_K = mean(points))
View(Ave_K)
projections <- read.csv(file = "data/Projections.csv")
Ave_Def <- projections %>%
filter(Year > 2013, playerposition == "DST") %>%
group_by(player) %>%
summarize(Ave_Def = mean(points))
#Calculate average defense projections for 2014 to 2016: Impute average score for 2012 and 2013 with no data
Ave_K <- projections %>%
filter(Year > 2013, playerposition == "K") %>%
group_by(player) %>%
summarize(Ave_K = mean(points))
View(Ave_Def)
projections <- read.csv(file = "data/Projections.csv")
Ave_Def <- projections %>%
filter(Year > 2013, playerposition == "DST") %>%
group_by(player) %>%
summarize(Ave_Def = mean(points))
#Calculate average defense projections for 2014 to 2016: Impute average score for 2012 and 2013 with no data
Ave_K <- projections %>%
filter(Year > 2013, playerposition == "K") %>%
group_by(player) %>%
summarize(Ave_K = mean(points))
View(Ave_Def)
View(Ave_K)
Ave_K <- projections %>%
filter(Year > 2013, playerposition == "K") %>%
group_by(Year) %>%
summarize(Ave_K = mean(points))
View(Ave_K)
Ave_K <- projections %>%
filter(Year > 2013, playerposition == "K") %>%
group_by(player) %>%
summarize(Ave_K = mean(points))
proj <- projections %>%
plyr::rename(c('player' = 'Name','team' = 'Team','playerposition' = 'POS','points' = 'Proj_Pts')) %>%
select(Year,Name,Proj_Pts)
View(Ave_K)
testproj <- left_join(proj,Ave_Def, by = c('Name' = 'player'))
View(testproj)
projections <- read.csv(file = "data/Projections.csv")
View(projections)
projections$player <- ifelse(projections$player == "Leveon Bell","Le'veon Bell",projections$player)
projections <- read.csv(file = "data/Projections.csv")
projections$player[projections$player == "Leveon Bell"] <- "Le'Veon Bell"
projections$player[projections$player == "LeVeon Bell"] <- "Le'Veon Bell"
projections$player <- as.character(projections$player)
projections$player[projections$player == "LeVeon Bell"] <- "Le'Veon Bell"
View(projections)
projections <- read.csv(file = "data/Projections.csv")
projections$player <- as.character(projections$player)
projections$player[projections$player == "LeVeon Bell"] <- "Le'Veon Bell"
projections$player[projections$player == "Robert Griffin"] <- "Robert Griffin III"
projections$Name <- ifelse(projections$playerposition = "DST",projections$team,projections$player)
projections$Name <- ifelse(projections$playerposition == "DST",projections$team,projections$player)
projections$team <- as.character(projections$team)
projections$Name <- ifelse(projections$playerposition == "DST",projections$team,projections$player)
projections$Name[projections$Name == "LA"] <- "LAR"
projections$Name[projections$Name == "STL"] <- "LAR"
projections$Name[projections$Name == "LA"] <- "LAR"
projections$Name[projections$Name == "STL"] <- "LAR"
projections$Name[projections$Name == "JAC"] <- "JAX"
View(projections)
Ave_Def <- projections %>%
filter(Year > 2013, playerposition == "DST") %>%
group_by(player) %>%
summarize(Ave_Def = mean(points))
View(Ave_Def)
proj$Name <- trim(proj$Name)
projections$Name <- trim(projections$Name)
final <- projections %>%
plyr::rename(c('points' = 'Proj_Pts' )) %>%
select(Year,Name,Proj_Pts)
View(final)
final <- projections %>%
plyr::rename(c('points' = 'Proj_Pts','playerposition' = 'POS','team' = 'Team')) %>%
select(Year,Name,Team,POS,Proj_Pts)
source(file = 'readProj.R')
proj <- read_proj()
View(proj)
Ave_Def <- proj %>%
filter(Year > 2013, POS == "DST") %>%
group_by(Name) %>%
summarize(Ave_Def = mean(points))
View(Ave_Def)
Ave_Def <- proj %>%
filter(Year > 2013, POS == "DST") %>%
group_by(Name) %>%
summarize(Ave_Def = mean(Proj_Pts))
View(Ave_Def)
Ave_K <- proj %>%
filter(Year > 2013, POS == "K") %>%
group_by(Name) %>%
summarize(Ave_K = mean(Proj_Pts))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name'))
test <- Draft_Act_Proj[is.na(Draft_Act_Proj$Proj_Pts),]
View(test)
View(Ave_K)
View(Draft_Act_Proj)
View(draft)
draft <- select(draft,Year,Round,Pick,Name,POS,Team,WR,RB,QB,TE,DEF,K)
draft <- read.csv(file = "data/Draft_Data.csv")
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,POS,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
source(file = 'actuals.R')
source(file = 'readProj.R')
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
proj <- read_proj()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,POS,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
test <- Draft_Act_Proj[is.na(Draft_Act_Proj$Proj_Pts),]
View(test)
projections$playerposition[projections$playerposition == "DST"] <- "DEF"
projections <- read.csv(file = "data/Projections.csv")
#Change name of Leveon Bell and RG3
projections$player <- as.character(projections$player)
projections$player[projections$player == "LeVeon Bell"] <- "Le'Veon Bell"
projections$player[projections$player == "Robert Griffin"] <- "Robert Griffin III"
#Assign Name of Player as the Team name for Defenses
projections$team <- as.character(projections$team)
projections$Name <- ifelse(projections$playerposition == "DST",projections$team,projections$player)
#Change name of DST to DEF
projections$playerposition[projections$playerposition == "DST"] <- "DEF"
projections <- read.csv(file = "data/Projections.csv")
projections <- read.csv(file = "data/Projections.csv")
#Change name of Leveon Bell and RG3
projections$player <- as.character(projections$player)
projections$player[projections$player == "LeVeon Bell"] <- "Le'Veon Bell"
projections$player[projections$player == "Robert Griffin"] <- "Robert Griffin III"
#Assign Name of Player as the Team name for Defenses
projections$team <- as.character(projections$team)
projections$Name <- ifelse(projections$playerposition == "DST",projections$team,projections$player)
projections$playerposition <- as.character(projections$playerposition)
projections$playerposition[projections$playerposition == "DST"] <- "DEF"
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
proj <- read_proj()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,POS,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
test <- Draft_Act_Proj[is.na(Draft_Act_Proj$Proj_Pts),]
View(test)
View(proj)
source(file = 'actuals.R')
source(file = 'readProj.R')
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
proj <- read_proj()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,POS,Team,WR,RB,QB,TE,DEF,K)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
test <- Draft_Act_Proj[is.na(Draft_Act_Proj$Proj_Pts),]
View(test)
View(Draft_Act_Proj)
View(Ave_Def)
Draft_Act_Proj_00 <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
Draft_Act_Proj_01 <- left_join(Draft_Act_Proj_00,Ave_Def, by = c('Name' = 'Name'))
Draft_Act_Proj_02 <- left_join(Draft_Act_Proj_01,Ave_K, by = c('Name' = 'Name'))
View(Draft_Act_Proj_02)
Draft_Act_Proj_02$Test <- ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "DEF",Draft_Act_Proj_02$Ave_Def,
ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "K",Draft_Act_Proj_02$Ave_Def,
Draft_Act_Proj_02$Proj_Pts))
Draft_Act_Proj_02$Test <- ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "DEF",Draft_Act_Proj_02$Ave_Def,
ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "K",Draft_Act_Proj_02$Ave_K,
Draft_Act_Proj_02$Proj_Pts))
test <- Draft_Act_Proj_02[is.na(Draft_Act_Proj_02$Proj_Pts),]
test <- Draft_Act_Proj_02[is.na(Draft_Act_Proj_02$Test),]
View(test)
source(file = 'actuals.R')
source(file = 'readProj.R')
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
proj <- read_proj()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,POS,Team,WR,RB,QB,TE,DEF,K)
Ave_Def <- proj %>%
filter(Year > 2013, POS == "DST") %>%
group_by(Name) %>%
summarize(Ave_Def = mean(Proj_Pts))
#Calculate average defense projections for 2014 to 2016: Impute average score for 2012 and 2013 with no data
Ave_K <- proj %>%
filter(Year > 2013, POS == "K") %>%
group_by(Name) %>%
summarize(Ave_K = mean(Proj_Pts))
###MERGE DRAFT RESULTS, PROJECTED FF PTS, AND ACTUAL FF PTS
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj_00 <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
Draft_Act_Proj_01 <- left_join(Draft_Act_Proj_00,Ave_Def, by = c('Name' = 'Name'))
Draft_Act_Proj_02 <- left_join(Draft_Act_Proj_01,Ave_K, by = c('Name' = 'Name'))
Draft_Act_Proj_02$Test <- ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "DEF",Draft_Act_Proj_02$Ave_Def,
ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "K",Draft_Act_Proj_02$Ave_K,
Draft_Act_Proj_02$Proj_Pts))
test <- Draft_Act_Proj_02[is.na(Draft_Act_Proj_02$Test),]
View(test)
View(Draft_Act_Proj)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
View(proj)
Draft_Act_Proj_00 <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
Draft_Act_Proj_01 <- left_join(Draft_Act_Proj_00,Ave_Def, by = c('Name' = 'Name'))
Draft_Act_Proj_02 <- left_join(Draft_Act_Proj_01,Ave_K, by = c('Name' = 'Name'))
View(Draft_Actuals)
View(Draft_Act_Proj_02)
View(Draft_Act_Proj_01)
View(Ave_Def)
Ave_Def <- proj %>%
filter(Year > 2013, POS == "DEF") %>%
group_by(Name) %>%
summarize(Ave_Def = mean(Proj_Pts))
#Calculate average defense projections for 2014 to 2016: Impute average score for 2012 and 2013 with no data
Ave_K <- proj %>%
filter(Year > 2013, POS == "K") %>%
group_by(Name) %>%
summarize(Ave_K = mean(Proj_Pts))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
draft$Name <- trim(draft$Name)
actuals$Name <- trim(actuals$Name)
Draft_Actuals <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
Draft_Actuals[is.na(Draft_Actuals)] <- 0 #missing actuals for players drafted and did not play
Draft_Act_Proj_00 <- left_join(Draft_Actuals,proj, by = c('Year' = 'Year','Name' = 'Name','POS' = 'POS'))
Draft_Act_Proj_01 <- left_join(Draft_Act_Proj_00,Ave_Def, by = c('Name' = 'Name'))
Draft_Act_Proj_02 <- left_join(Draft_Act_Proj_01,Ave_K, by = c('Name' = 'Name'))
Draft_Act_Proj_02$Test <- ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "DEF",Draft_Act_Proj_02$Ave_Def,
ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "K",Draft_Act_Proj_02$Ave_K,
Draft_Act_Proj_02$Proj_Pts))
test <- Draft_Act_Proj_02[is.na(Draft_Act_Proj_02$Test),]
View(test)
View(Draft_Actuals)
View(Draft_Act_Proj_02)
Draft_Act_Proj <- Draft_Act_Proj_02 %>%
select(-Proj_Pts,-Ave_Def,-Ave_K)
View(Draft_Act_Proj_00)
View(Draft_Actuals)
View(Draft_Act_Proj_01)
View(Draft_Act_Proj_02)
View(Draft_Act_Proj)
Draft_Act_Proj_02$Projections <- ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "DEF",Draft_Act_Proj_02$Ave_Def,
ifelse(Draft_Act_Proj_02$Year < 2014 & Draft_Act_Proj$POS == "K",Draft_Act_Proj_02$Ave_K,
Draft_Act_Proj_02$Proj_Pts))
Draft_Act_Proj <- Draft_Act_Proj_02 %>%
select(-Proj_Pts,-Ave_Def,-Ave_K)
Draft_Act_Proj[is.na(Draft_Act_Proj)] <- 0
test <- Draft_Act_Proj_02[is.na(Draft_Act_Proj$Projections),]
Draft_Act_Proj[is.na(Draft_Act_Proj)] <- Draft_Act_Proj$Fantasy_Pts
View(Draft_Actuals)
View(Draft_Act_Proj_02)
View(Draft_Act_Proj_01)
View(Draft_Act_Proj)
