library(shiny)
library(shinyjs)
library(shinyFiles)
library(rsconnect)
library(reshape2)
require(plyr)
library(dplyr)
library(DT)
library(data.table)
library(ggplot2)
library(ggthemes)
library(scales)
library(googleVis)
library(rvest)
library(xml2)
library(XML)
library(plotly)
library(DT)
library(tidyr)
library(stringr)
library(nflscrapR)
players2012 <- season_player_game(2012)
players2013 <- season_player_game(2013)
players2014 <- season_player_game(2014)
players2015 <- season_player_game(2015)
players2016 <- season_player_game(2016)
PlayerStats <- bind_rows(players2015,players2016)
View(PlayerStats)
test <- nflscrapR::agg_player_season(2016,Weeks = 16)
View(test)
test <- nflscrapR::season_rosters(2016,Weeks = 16,NO)
test <- nflscrapR::season_rosters(2016,Weeks = 16,'NO')
View(test)
draft <- read.csv(file = "data/Draft_Data.csv")
setwd("C:/Users/Michael Surace/Desktop/Personal Projects/FF-WebApp/app")
getwd()
draft <- read.csv(file = "data/Draft_Data.csv")
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
PlayerStats$dummy <- gsub('Jr',"",gsub('Jr.',"",PlayerStats$name))
PlayerStats$Name <- gsub('Sr.',"",PlayerStats$dummy)
PlayerStats$ID <- gsub(" ","",paste(toupper(PlayerStats$Team),toupper(PlayerStats$Name),sep ='-'))
PlayerStats <- plyr::rename(PlayerStats,c('Team' = 'NFL_Team'))
View(PlayerStats)
View(draft)
draft$dummy <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$dummy))
draft$Name <- gsub('Sr.',"",draft$dummy)
draft$Name <- paste(substr(draft$Player,1,1),stringr::word(draft$Player,2),sep = '.')
draft <- read.csv(file = "data/Draft_Data.csv")
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$dummy <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$dummy <- gsub('Jr',"",gsub('Jr.',"",draft$dummy))
draft$dummy <- gsub('Sr.',"",draft$dummy)
draft$Name <- paste(substr(draft$dummy,1,1),stringr::word(draft$dummy,2),sep = '.')
gamestats <- PlayerStats %>%
mutate(pass_pts = passyds/25 + pass.tds*4 - pass.ints*2 + pass.twoptm*2,
rush_pts = rushyds/10 + rushtds*6 + rush.twoptm*2 - fumbslost*2,
rec_pts = recept*.5 + recyds/10 + rec.tds*6 + rec.twoptm*2,
spec_pts = kickret.tds*6 + puntret.tds*6,
total_pts = pass_pts + rush_pts + rec_pts + spec_pts) %>%
filter(total_pts > 0) %>%
select(Season,ID, pass_pts,rush_pts,rec_pts,spec_pts, total_pts)%>%
group_by(Season, ID) %>%
summarise(season_pts = sum(total_pts))
View(gamestats)
gamestats <- PlayerStats %>%
mutate(pass_pts = passyds/25 + pass.tds*4 - pass.ints*2 + pass.twoptm*2,
rush_pts = rushyds/10 + rushtds*6 + rush.twoptm*2 - fumbslost*2,
rec_pts = recept*.5 + recyds/10 + rec.tds*6 + rec.twoptm*2,
spec_pts = kickret.tds*6 + puntret.tds*6,
total_pts = pass_pts + rush_pts + rec_pts + spec_pts) %>%
filter(total_pts > 0) %>%
select(Season,ID, pass_pts,rush_pts,rec_pts,spec_pts, total_pts)%>%
group_by(Season, Name) %>%
summarise(season_pts = sum(total_pts))
gamestats <- PlayerStats %>%
mutate(pass_pts = passyds/25 + pass.tds*4 - pass.ints*2 + pass.twoptm*2,
rush_pts = rushyds/10 + rushtds*6 + rush.twoptm*2 - fumbslost*2,
rec_pts = recept*.5 + recyds/10 + rec.tds*6 + rec.twoptm*2,
spec_pts = kickret.tds*6 + puntret.tds*6,
total_pts = pass_pts + rush_pts + rec_pts + spec_pts) %>%
filter(total_pts > 0) %>%
select(Season,Name, pass_pts,rush_pts,rec_pts,spec_pts, total_pts)%>%
group_by(Season, Name) %>%
summarise(season_pts = sum(total_pts))
gamestats <- PlayerStats %>%
mutate(pass_pts = passyds/25 + pass.tds*4 - pass.ints*2 + pass.twoptm*2,
rush_pts = rushyds/10 + rushtds*6 + rush.twoptm*2 - fumbslost*2,
rec_pts = recept*.5 + recyds/10 + rec.tds*6 + rec.twoptm*2,
spec_pts = kickret.tds*6 + puntret.tds*6,
total_pts = pass_pts + rush_pts + rec_pts + spec_pts) %>%
filter(total_pts > 0) %>%
select(Season,Name,NFL_Team, pass_pts,rush_pts,rec_pts,spec_pts, total_pts)%>%
group_by(Season, Name, NFL_Team) %>%
summarise(season_pts = sum(total_pts))
gamestats <- PlayerStats %>%
mutate(pass_pts = passyds/25 + pass.tds*4 - pass.ints*2 + pass.twoptm*2,
rush_pts = rushyds/10 + rushtds*6 + rush.twoptm*2 - fumbslost*2,
rec_pts = recept*.5 + recyds/10 + rec.tds*6 + rec.twoptm*2,
spec_pts = kickret.tds*6 + puntret.tds*6,
total_pts = pass_pts + rush_pts + rec_pts + spec_pts) %>%
filter(total_pts > 0) %>%
select(Season,Name,NFL_Team, pass_pts,rush_pts,rec_pts,spec_pts, total_pts)%>%
group_by(Season, Name, NFL_Team) %>%
summarise(season_pts = sum(total_pts)) %>%
filter(season_pts > 5)
devtools::install_github(repo = "BurntSushi/nflgame")
install.packages("devtools")
devtools::install_github("stattleship/stattleship-r")
library(devtools)
library(devtools)
devtools::install_github("stattleship/stattleship-r")
library(stattleshipR)
set_token("13cd7d0d73c5a5779864f992d1804623")
sport <- 'football'
league <- 'nfl'
ep <- 'game_logs'
q_body <- list(status='ended', interval_type='regularseason')
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body, walk=TRUE)
game_logs<-do.call('rbind', lapply(gls, function(x) x$game_logs))
gls
q_body <- list(team_id = 'nfl-nyg',status='ended', interval_type='regularseason')
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body, walk=TRUE)
gls
sport <- 'baseball'
league <- 'mlb'
ep <- 'game_logs'
q_body <- list(team_id = 'mlb-bos',status='ended', interval_type='regularseason')
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body, walk=TRUE)
sport <- 'baseball'
league <- 'mlb'
ep <- 'game_logs'
q_body <- list(team_id='mlb-bos', status='ended', interval_type='regularseason')
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body, walk=TRUE)
sport <- 'football'
league <- 'nfl'
ep <- 'game_logs'
q_body <- list(team_id='nfl-ne', status='ended', interval_type='regularseason')
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body, walk=TRUE)
q_body <- list(team_id='nfl-ne', status='ended', interval_type='regularseason', season_id = 'nfl-2015-2016')
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body, walk=TRUE)
gls <- ss_get_result(sport=sport, league=league, ep=ep, query=q_body)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(scales)
pop_A <-  rbinom(100000,1,0.3)
pop_B <-  rbinom(10000,1,0.3)
n0 = ceiling(2.706 * 0.3 * (1-0.3) / 0.025^2)
print(paste0("The sample size for population A is: ", n0))
n0 = ceiling(2.706 * 0.3 * (1-0.3) / 0.025^2)
print(paste0("The sample size for population B is: ", n0))
sampA <- sapply(seq(1:100), function(x){
pop_A %>%
sample(910,replace = TRUE) %>%
mean()
})
print(paste0("The mean IP rate of the samples for population A is: ",
round(mean(sampA),2)))
print(paste0("The variance of the IP rates of the samples for population A is: ",
round(var(sampA),6)))
sampB <- sapply(seq(1:100), function(x){
pop_B %>%
sample(910,replace = TRUE) %>%
mean()
})
print(paste0("The mean IP rate of the samples for population B is: ",
round(mean(sampB),2)))
print(paste0("The variance of the IP rates of the samples for population B is: ",
round(var(sampB),6)))
pop_A_samps <- data.frame(IP_rate = sampA, Group = "pop_A_samps")
pop_B_samps <- data.frame(IP_rate = sampB, Group = "pop_B_samps")
#combine population A and B samples
comb_samps <- rbind(pop_A_samps,pop_B_samps)
#Plot estimated IP rates distribution
comb_samps %>%
ggplot(aes(x = Group,y = IP_rate, fill = Group)) +
scale_y_continuous(limits = c(0.25,0.35)) +
geom_boxplot() +
theme_bw() +
theme(legend.position = 'none', plot.title = element_text(hjust = 0.5),
axis.text.y=element_text(angle = 0)) +
labs(x = "Population Groups" , y = "IP Rates",
title = "IP Rate Boxplot Comparison")
View(PlayerStats)
devtools::install_github(repo = "dadrivr/FantasyFootballAnalyticsR",  subdir = "R Package/ffanalytics")
devtools::install_github(repo = "dadrivr/FantasyFootballAnalyticsR",  subdir = "R Package/ffanalytics")
View(PlayerStats)
write.csv(Players2016,file = "C:/Users/Michael Surace/Desktop/2016stats.csv")
View(players2016)
write.csv(players2016,file = "C:/Users/Michael Surace/Desktop/2016stats.csv")
write.csv(PlayerStats, file = "C:/Users/Michael Surace/Desktop/PlayerStats.csv")
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Pass_Stats.csv")
View(rush_stats)
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Passing_Stats.csv")
View(pass_stats)
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Passing_Stats.csv")
pr_stats <- read.csv(file = "data/PR_Stats.csv")
kr_stats <- read.csv(file = "data/KR_Stats.csv")
Hist_Stats <- bind_rows(rush_stats,catch_stats,pass_stats,kr_stats,pr_stats)
View(catch_stats)
View(rush_stats)
View(kr_stats)
View(rush_stats)
data <- rush_stats %>%
mutate(Rush_Yds <- as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Rush_Yds,TD) %>%
plyr::rename(c('TD' = 'Rush_Td'))
data <- rush_stats %>%
mutate(Rush_Yds = as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Rush_Yds,TD) %>%
plyr::rename(c('TD' = 'Rush_Td'))
View(data)
rush_stats <- rush_stats %>%
mutate(Rush_Yds = as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Rush_Yds,TD) %>%
plyr::rename(c('TD' = 'Rush_Td'))
View(catch_stats)
test <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Rec, Rush_Yds,TD) %>%
plyr::rename(c('TD' = 'Rec_Td'))
test <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Rec, Rec_Yds,TD) %>%
plyr::rename(c('TD' = 'Rec_Td'))
View(test)
catch_stats <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Rec, Rec_Yds,TD) %>%
plyr::rename(c('TD' = 'Rec_Td'))
View(pass_stats)
test <- pass_stats %>%
mutate(Pass_Yds = as.numeric(as.character(gsub(",","",Yds)))) %>%
select(Year,POS,Player,Pass_Yds,TD,Int) %>%
plyr::rename(c('TD' = 'Pass_Td'))
View(test)
rush_stats <- rush_stats %>%
mutate(Points = Rush_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Passing_Stats.csv")
pr_stats <- read.csv(file = "data/PR_Stats.csv")
kr_stats <- read.csv(file = "data/KR_Stats.csv")
rush_stats <- rush_stats %>%
mutate(Points = Rush_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
rush_stats <- rush_stats %>%
mutate(Points = Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
View(rush_stats)
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Passing_Stats.csv")
pr_stats <- read.csv(file = "data/PR_Stats.csv")
kr_stats <- read.csv(file = "data/KR_Stats.csv")
rush_stats <- rush_stats %>%
mutate(Rush_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rush_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
View(rush_stats)
catch_stats <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rec_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
View(catch_stats)
catch_stats <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rec*.5 + Rec_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Passing_Stats.csv")
pr_stats <- read.csv(file = "data/PR_Stats.csv")
kr_stats <- read.csv(file = "data/KR_Stats.csv")
#Format Calculate Rush Fantasy Points
rush_stats <- rush_stats %>%
mutate(Rush_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rush_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
#Format Catch Statistics
catch_stats <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rec*.5 + Rec_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
test <- pass_stats %>%
mutate(Pass_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Pass_Yds*.04 + TD*4 + Int*-1) %>%
select(Year,POS,Player,Points)
View(test)
kr_stats <- kr_stats %>%
mutate(Points = TD*6) %>%
select(Year,POS,Player,Points)
View(kr_stats)
pr_stats <- pr_stats %>%
mutate(Points = TD*6) %>%
select(Year,POS,Player,Points)
View(pr_stats)
Hist_Stats <- bind_rows(rush_stats,catch_stats,pass_stats,kr_stats,pr_stats)
View(Hist_Stats)
rush_stats <- read.csv(file = "data/Rushing_Stats.csv")
catch_stats <- read.csv(file = "data/Recieving_Stats.csv")
pass_stats <- read.csv(file = "data/Passing_Stats.csv")
pr_stats <- read.csv(file = "data/PR_Stats.csv")
kr_stats <- read.csv(file = "data/KR_Stats.csv")
#Calculate Rush Fantasy Points
rush_stats <- rush_stats %>%
mutate(Rush_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rush_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
#Calculate Receiving Fantasy Points
catch_stats <- catch_stats %>%
mutate(Rec_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Rec*.5 + Rec_Yds*.1 + TD*6) %>%
select(Year,POS,Player,Points)
#Calculate Pass Fantasy Points
pass_stats <- pass_stats %>%
mutate(Pass_Yds = as.numeric(as.character(gsub(",","",Yds))),
Points = Pass_Yds*.04 + TD*4 + Int*-1) %>%
select(Year,POS,Player,Points)
#Calculate KR Fantasy Points
kr_stats <- kr_stats %>%
mutate(Points = TD*6) %>%
select(Year,POS,Player,Points)
#Calculate PR Fantasy Points
pr_stats <- pr_stats %>%
mutate(Points = TD*6) %>%
select(Year,POS,Player,Points)
Hist_Stats <- bind_rows(rush_stats,catch_stats,pass_stats,kr_stats,pr_stats)
View(Hist_Stats)
Hist_Stats <- bind_rows(rush_stats,catch_stats,pass_stats,kr_stats,pr_stats) %>%
group_by(Season,Player) %>%
summarize(Fantasy_Pts = sum(Points))
Hist_Stats <- bind_rows(rush_stats,catch_stats,pass_stats,kr_stats,pr_stats) %>%
group_by(Year,Player) %>%
summarize(Fantasy_Pts = sum(Points))
View(Hist_Stats)
source(file = 'actuals.R')
source(file = 'actuals.R')
getwd()
source(file = 'actuals.R')
actuals <- read_hist()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
View(draft)
View(draft)
View(actuals)
Hist_Stats$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(Hist_Stats$Player))
Hist_Stats$Name <- gsub('Jr',"",gsub('Jr.',"",Hist_Stats$dummy))
Hist_Stats$Name <- gsub('Sr.',"",Hist_Stats$dummy)
Hist_Stats$dummy <- gsub("\\s*\\([^\\)]+\\)","",as.character(Hist_Stats$Player))
Hist_Stats$dummy <- gsub('Jr',"",gsub('Jr.',"",Hist_Stats$dummy))
Hist_Stats$Name <- gsub('Sr.',"",Hist_Stats$dummy)
View(Hist_Stats)
final <- select(Hist_Stats,-dummy,-Player)
View(final)
final <- select(Hist_Stats,Year,Name,Fantasy_Pts)
source(file = 'actuals.R')
reg_data <- read.csv(file = "data/Reg_Data.csv" )
playoff_data <- read.csv(file = "data/Playoff_Data.csv")
proj <- read.csv(file = "data/2017proj.csv")
draft <- read.csv(file = "data/Draft_Data.csv")
actuals <- read_hist()
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$dummy))
draft$Name <- gsub('Sr.',"",draft$dummy)
draft <- read.csv(file = "data/Draft_Data.csv")
draft$WR <- ifelse(draft$POS == "WR",1,0)
draft$RB <- ifelse(draft$POS == "RB",1,0)
draft$QB <- ifelse(draft$POS == "QB",1,0)
draft$TE <- ifelse(draft$POS == "TE",1,0)
draft$DEF <- ifelse(draft$POS == "DEF",1,0)
draft$K <- ifelse(draft$POS == "K",1,0)
View(draft)
draft$Name <- gsub("\\s*\\([^\\)]+\\)","",as.character(draft$Player))
draft$Name <- gsub('Jr',"",gsub('Jr.',"",draft$Name))
draft$Name <- gsub('Sr.',"",draft$Name)
draft <- select(draft,Year,Round,Pick,Name,Team,WR,RB,QB,TE,DEF,K)
all <- left_join(draft,actuals, by = list(c('Season' = 'Year','Name' = 'Name')))
all <- left_join(draft,actuals, by = c('Season' = 'Year','Name' = 'Name'))
all <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
View(all)
final_draft <- left_join(draft,actuals, by = c('Year' = 'Year','Name' = 'Name'))
final_draft[is.na(final_draft$Fantasy_Pts)] <- 0
View(final_draft)
final_draft$Fantasy_Pts[is.na(final_draft$Fantasy_Pts)] <- 0
View(final_draft)
